---
emoji: ğŸ§¢
title: CIì™€ í…ŒìŠ¤íŠ¸
date: '2024-01-16 14:00:00'
author: Hack
tags: Road Of Programmer
categories: ì‚¬ì´ë“œí”„ë¡œì íŠ¸
---

## ë„ì…

ì•ˆë…•í•˜ì„¸ìš”, Road Of Programmerë¥¼ ê°œë°œí•˜ê³  ìˆëŠ” Hackì…ë‹ˆë‹¤.  
í”„ë¡œì íŠ¸ë¥¼ ê°œë°œí•˜ë©´ì„œ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸°ë¡œ í–ˆê³  ì´ë¥¼ ìœ„í•œ CI í™˜ê²½ì„ êµ¬ì„±í•  ì˜ˆì •ì…ë‹ˆë‹¤.  
í™˜ê²½ì„ êµ¬ì„±í•˜ê¸°ì— ì•ì„œ í…ŒìŠ¤íŠ¸ì½”ë“œì˜ ê°œë…ê³¼ í…ŒìŠ¤íŠ¸ ì‘ì„±ë°©ì‹ ê·¸ë¦¬ê³  CI í™˜ê²½ì— ëŒ€í•´ ì‚¬ì „ ì¡°ì‚¬ë¥¼ ì§„í–‰í•˜ì˜€ê³  ì¡°ì‚¬í•œ ë‚´ìš©ì„ ê¸€ë¡œ ì •ë¦¬ í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.

## í…ŒìŠ¤íŠ¸ ì½”ë“œë€?

í…ŒìŠ¤íŠ¸ë€ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ì—¬ ê°œë°œìê°€ ì›í•˜ëŠ” ëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸ í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤.  
ì´ëŸ¬í•œ ì¼ë ¨ì˜ ì ˆì°¨ë¥¼ `ì½”ë“œë¡œ ì‘ì„±í•˜ì—¬ ìë™í™”`í•˜ë©´ ë§ì€ ê¸°ëŠ¥ì— ëŒ€í•´ì„œ ìˆ˜ë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ì‹œê°„ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ìë™í™”ëœ í…ŒìŠ¤íŠ¸ëŠ” ì½”ë“œ ìˆ˜ì •ì— `ì‹¬ë¦¬ì ì¸ ì•ˆì •ê°`ì„ ì¤„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í”„ë¡œì íŠ¸ì— ë„ì…í•˜ê¸°ë¡œ ê²°ì • í–ˆìŠµë‹ˆë‹¤.

### ìœ ë‹›(ë‹¨ìœ„) í…ŒìŠ¤íŠ¸ë€?

ê°œë°œìê°€ ìˆ˜í–‰í•˜ê³  ìì‹ ì´ ê°œë°œ í•œ ì½”ë“œ ë‹¨ìœ„ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.  
ì†ŒìŠ¤ì½”ë“œì˜ `ê°œë³„ ë‹¨ìœ„(ì£¼ë¡œ ë©”ì†Œë“œ)`ë¥¼ í…ŒìŠ¤íŠ¸í•˜ì—¬ ì‚¬ìš©í•  ì¤€ë¹„ê°€ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.  
ê°œë°œ ì´ˆê¸°ì— ë²„ê·¸ë¥¼ ì‹ë³„í•˜ëŠ”ë° ë„ì›€ì´ë˜ì–´ ë²„ê·¸ ìˆ˜ì • ì‹œê°„ì„ ì¤„ì´ëŠ”ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.

#### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ ì¡°ê±´

- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ë…ë¦½ì ì´ì–´ì•¼ í•˜ë©°, ì–´ë–¤ í…ŒìŠ¤íŠ¸ë„ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì˜ì¡´í•´ì„œëŠ” ì•ˆë©ë‹ˆë‹¤.
- ì™¸ë¶€ ì˜ì¡´ì„±ê³¼ ê²©ë¦¬ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

### í†µí•© í…ŒìŠ¤íŠ¸ë€?

í†µí•© í…ŒìŠ¤íŠ¸ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë³´ë‹¤ í° ë²”ìœ„ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì˜ë¯¸í•˜ë©° ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì—¬ëŸ¬ ë¶€ë¶„ì„ í†µí•©í•˜ì—¬ ì œëŒ€ë¡œ ìƒí˜¸ì‘ìš© ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.  
ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ í•˜ë‚˜ì˜ ë©”ì†Œë“œë¥¼ í…ŒìŠ¤íŠ¸í•œë‹¤ë©´ í†µí•©í…ŒìŠ¤íŠ¸ëŠ” í•˜ë‚˜ì˜ ë©”ì†Œë“œê°€ ì˜ì¡´í•˜ëŠ” ë‹¤ë¥¸ ì˜ì¡´ì„±ê¹Œì§€ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê²Œ ë©ë‹ˆë‹¤.

### E2E í…ŒìŠ¤íŠ¸ë€?

End to End í…ŒìŠ¤íŠ¸ì˜ ì•½ìë¡œ ì‹¤ì œ ì‚¬ìš©ìê°€ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ì¡°ê±´ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ë§í•©ë‹ˆë‹¤.
ì‹¤ì œ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê°€ì§€ê³  í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.  
ì£¼ë¡œ Cypress Puppeteer ê°™ì€ íˆ´ì„ ì´ìš©í•˜ì—¬ ìë™í™”ëœ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.

> ê³µë¶€í•˜ë©´ì„œ ë‚´ìš©ì„ ì •ë¦¬í•˜ê¸´ í–ˆì§€ë§Œ ì›ë˜ í†µí•©í…ŒìŠ¤íŠ¸ì™€ E2E í…ŒìŠ¤íŠ¸ì˜ êµ¬ë¶„ì´ ëª¨í˜¸í•œ ê²ƒì¸ì§€ ì°¨ì´ì ì„ ì˜ ëª°ë¥´ê² ìŠµë‹ˆë‹¤..ğŸ¤”  
> ê·¸ë˜ì„œ ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” í†µí•©í…ŒìŠ¤íŠ¸ E2Eí…ŒìŠ¤íŠ¸ë¥¼ êµ¬ë¶„í•˜ì§€ ì•Šê³  E2Eí…ŒìŠ¤íŠ¸(ì»¨íŠ¸ë¡¤ëŸ¬ -> DB) ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì¡°í•©í•´ì„œ í™œìš©í•˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.

### í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ë€

í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ë€ ìˆ˜í–‰í•œ í…ŒìŠ¤íŠ¸ê°€ í…ŒìŠ¤íŠ¸ì˜ ëŒ€ìƒì„ ì–´ëŠì •ë„ ì»¤ë²„í–ˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œì…ë‹ˆë‹¤.  
ì»¤ë²„ë¦¬ì§€ ì§€í‘œë¡œëŠ” ì–¼ë§ˆë‚˜ ì»¤ë²„í–ˆëŠëƒì— ë”°ë¼ ê¸°ì¤€ì„ ë‚˜ëˆ•ë‹ˆë‹¤.

- êµ¬ë¬¸ ì»¤ë²„ë¦¬ì§€
- ê²°ì • ì»¤ë²„ë¦¬ì§€
- ì¡°ê±´ ì»¤ë²„ë¦¬ì§€

#### êµ¬ë¬¸ ì»¤ë²„ë¦¬ì§€

```ts
function(a: number) {
    console.log('hi'); // 1
    if(a > 0) { // 2
        a = 2; // 3
    } // 4
    print('hi') // 5
}
```

ëª¨ë“  ì½”ë“œê°€ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.  
ìœ„ ì½”ë“œì˜ ê²½ìš° `aê°€ ìŒìˆ˜ì¼ ê²½ìš°` ifë¬¸ ë‚´ë¶€ëŠ” ì‚¬ìš©ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì»¤ë²„ë¦¬ì§€ì—ì„œ ì œì™¸í•©ë‹ˆë‹¤.

#### ê²°ì •(ë¸Œëœì¹˜) ì»¤ë²„ë¦¬ì§€

```ts
function(a: number, b: number) {
    if(a > 0 && b > 0) {
        console.log('hi~')
    }
}
```

ì™¸ë¶€ ì¡°ê±´ì— ëŒ€í•˜ì—¬ True/falseë¥¼ ê°€ì§€ê²Œ ë˜ë©´ ë§Œì¡±í•©ë‹ˆë‹¤.
ìœ„ ì½”ë“œì—ì„œëŠ” `a > 0 && b >0`ì¸ ë¶€ë¶„ì˜ ì¡°ê±´ì‹ì´ true, falseì¸ ë‘ ê°€ì§€ ê²½ìš°ë¥¼ ëª¨ë‘ í…ŒìŠ¤íŠ¸í•´ì•¼ ë¸Œëœì¹˜ ì»¤ë²„ë¦¬ì§€ê°€ ì¶©ì¡±ë©ë‹ˆë‹¤.

#### ì¡°ê±´ì»¤ë²„ë¦¬ì§€

```ts
function(a: number, b: number) {
    if(a > 0 && b < 0) {
        console.log('hi~')
    }
}
```

ëª¨ë“  ë‚´ë¶€ì¡°ê±´ì— ëŒ€í•´ True/Falseë¥¼ ê°€ì§€ê²Œ ë˜ë©´ ë§Œì¡±í•©ë‹ˆë‹¤.  
ìœ„ ì½”ë“œì—ì„œ `a > 0` `b < 0`ì€ ë‚´ë¶€ ì¡°ê±´ì´ë©° ê° ì¡°ê±´ì´ true/falseì¸ ê²½ìš°ê°€ ìˆìœ¼ë©´ ì¡°ê±´ ì»¤ë²„ë¦¬ì§€ë¥¼ ë§Œì¡±í•©ë‹ˆë‹¤.

`a=1, b=1` `a=-1 b=-1`ì¸ ì½”ë“œë¥¼ í…ŒìŠ¤íŠ¸í•œë‹¤ê³  ê°€ì • í•´ë³´ê² ìŠµë‹ˆë‹¤.  
ë‚´ë¶€ ì¡°ê±´ì‹ `a>0`ê³¼ `b<0`ì€ ëª¨ë‘ ì–‘ìˆ˜ ìŒìˆ˜ì¼ë•Œê°€ ì¡´ì¬í•˜ë¯€ë¡œ ì¡°ê±´ ì»¤ë²„ë¦¬ì§€ë¥¼ ë§Œì¡±í•©ë‹ˆë‹¤.

í•˜ì§€ë§Œ 2ê°€ì§€ ê²½ìš° ëª¨ë‘ `a > 0 && b < 0`ì˜ ê²°ê³¼ê°€ falseì´ê¸° ë•Œë¬¸ì— ê²°ê³¼ì ìœ¼ë¡œ ì¡°ê±´ë¬¸ ë‚´ë¶€ëŠ” í…ŒìŠ¤íŠ¸í•˜ì§€ ëª»í•˜ê²Œ ë©ë‹ˆë‹¤.

### Nestì—ì„œ ì»¤ë²„ë¦¬ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ë°©ë²•

Nestjsì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì»¤ë²„ë¦¬ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ë°©ë²•(jest)ì„ ì œê³µí•©ë‹ˆë‹¤.

```json
  "scripts": {
    "build": "nest build",
    "format": "prettier --write \"src/**/*.ts\" \"test/**/*.ts\"",
    "start": "nest start",
    "start:dev": "nest start --watch",
    "start:debug": "nest start --debug --watch",
    "start:prod": "node dist/main",
    "lint": "eslint \"{src,apps,libs,test}/**/*.ts\" --fix",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:cov": "jest --coverage",
    "test:debug": "node --inspect-brk -r tsconfig-paths/register -r ts-node/register node_modules/.bin/jest --runInBand",
    "test:e2e": "jest --config ./test/jest-e2e.json"
  }
```

ìœ„ì— ë³´ì´ëŠ” jsonì€ nestjsì˜ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ë©´ ë³´ì´ëŠ” package.jsoníŒŒì¼ì…ë‹ˆë‹¤.  
í•´ë‹¹ í”„ë¡œì íŠ¸ì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì»¤ë²„ë¦¬ì§€ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤.

```sh
yarn test:cov
```

<br/>
<br/>

![ì»¤ë²„ë¦¬ì§€ ì¸¡ì • ê²°ê³¼](coverage.png)  
ìœ„ í™”ë©´ì€ ì»¤ë²„ë¦¬ì§€ê°€ ì¸¡ì •ëœ ê²°ê³¼ì…ë‹ˆë‹¤.

<br/>
<br/>

![ì»¤ë²„ë¦¬ì§€íŒŒì¼ ìœ„ì¹˜](coverage-index-html.png)
ì»¤ë²„ë¦¬ì§€ê°€ ì¸¡ì •ë˜ê³  ë‚œ í›„ì—ëŠ” ìœ„ì™€ ê°™ì€ ìœ„ì¹˜ì— htmlë¡œ ëœ ë³´ê³ ì„œê°€ ìƒê¹ë‹ˆë‹¤.

<br/>
<br/>

![ì»¤ë²„ë¦¬ì§€ ê²°ê³¼ ì›¹](coverage-web.png)
í•´ë‹¹ ë³´ê³ ì„œë¥¼ ì—´ì–´ë³´ë©´ ì»¤ë²„ë¦¬ì§€ ì¸¡ì • ê²°ê³¼ë¥¼ ì›¹ì—ì„œë„ í™•ì¸ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## CIë€?

![Alt text](CI.png)

CIë€ ì—¬ëŸ¬ ê°œë°œìì˜ ì½”ë“œ ë³€ê²½ ì‚¬í•­ì„ ê³µìœ  ì €ì¥ì†Œì— ì§€ì†ì ìœ¼ë¡œ í†µí•©í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤.  
ì œê°€ ì´í•´í•œ ë°”ë¡œëŠ” ì½”ë“œë¥¼ ë‹¨ìˆœíˆ í†µí•©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, í…ŒìŠ¤íŠ¸ë¥¼ ìë™í™”í•˜ê³ , ì½”ë“œë¥¼ í†µí•©í•˜ê¸° ì „ í…ŒìŠ¤íŠ¸ë¥¼ ìë™í™”í•˜ê³ , ì •ì ë¶„ì„ì„ ì‹¤í–‰í•˜ëŠ” ì¼ë ¨ì˜ ì½”ë“œí€„ë¦¬í‹°ë¥¼ ë³´ì¥í•˜ëŠ” ì‘ì—…ì„ ìë™í™”í•˜ë©° ì½”ë“œë¥¼ í†µí•©í•˜ëŠ” ê²ƒì„ ë§í•©ë‹ˆë‹¤.

CIë¥¼ í†µí•´ í†µí•©ëœ ì½”ë“œëŠ” í…ŒìŠ¤íŠ¸ ë° ì •ì ë¶„ì„ë“± ì¼ë ¨ì˜ ì½”ë“œ í€„ë¦¬í‹°ë¥¼ ë³´ì¥í•˜ëŠ” ì‘ì—…ì´ ìˆ˜í–‰ëœ ì½”ë“œì´ê¸° ë•Œë¬¸ì— ê°œë°œìëŠ” ì•ˆì •ì ì¸ ë§ˆìŒìœ¼ë¡œ ë°°í¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## Github Actionsë€?

> GitHub Actionsë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ë°”ë¡œ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ì›Œí¬í”Œë¡œë¥¼ ìë™í™”, ì‚¬ìš©ì ì§€ì • ë° ì‹¤í–‰í•©ë‹ˆë‹¤. CI/CDë¥¼ í¬í•¨í•˜ì—¬ ì›í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ì‘ì—…ì„ ê²€ìƒ‰, ìƒì„± ë° ê³µìœ í•˜ê³  ì™„ì „íˆ ì‚¬ìš©ì ì •ì˜ëœ ì›Œí¬í”Œë¡œì—ì„œ ì‘ì—…ì„ ê²°í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Github Actionsë€ Githubì—ì„œ ì œê³µí•˜ëŠ” ì›Œí¬í”Œë¡œìš°ë¥¼ ìë™í™”í•˜ëŠ” íˆ´ì…ë‹ˆë‹¤.  
ê³µê°œ ì €ì¥ì†Œì¼ ê²½ìš° `ë¬´ë£Œ`ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©° ë‹¤ì–‘í•œ í”ŒëŸ¬ê·¸ì¸ì„ ì œê³µí•˜ì—¬ ì‰½ê²Œ CIí™˜ê²½ì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.

## Github Actionsë¥¼ ì´ìš©í•˜ì—¬ CI í™˜ê²½ êµ¬ì„±í•˜ê¸°

```yml
name: Server CI

on:
  push:
    branches: ['main']
  pull_request:
    branches: ['main']

jobs:
  build:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        node-version: [21.x] # ì›Œí¬ í”Œë¡œìš°ì—ì„œ ì‚¬ìš©í•  ë…¸ë“œ ë²„ì „

    env:
      working-directory: ./server #ì„œë²„ í´ë”ì—ì„œ ëª…ë ¹ì„ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•œ í™˜ê²½ ë³€ìˆ˜

    steps:
      - uses: actions/checkout@v3
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'yarn'
          cache-dependency-path: ./server/yarn.lock #ì˜ì¡´ì„±ì„ ì½ê¸° ìœ„í•´ yarn.lockíŒŒì¼ ì§€ì •
      # ì˜ì¡´ì„± ì„¤ì¹˜
      - name: Download Dependency
        run: yarn install
        working-directory: ${{ env.working-directory }}
      # ì½”ë“œ ìë™ í¬ë§¤íŒ…
      - name: Formatting By prettier
        run: yarn format
        working-directory: ${{ env.working-directory }}
      # ë¦°íŠ¸ ê²€ì‚¬
      - name: Lint By Eslint
        run: yarn lint
        working-directory: ${{ env.working-directory }}
      # í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
      - name: Test
        run: yarn test
        working-directory: ${{ env.working-directory }}
```

ìœ„ ì½”ë“œëŠ” í•´ë‹¹ í”„ë¡œì íŠ¸ì˜ ì„œë²„ì—ì„œ ì„ì‹œì ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆëŠ” CIíŒŒì´í”„ë¼ì¸ì…ë‹ˆë‹¤.  
mainë¸Œë Œì¹˜ì— ì½”ë“œê°€ í‘¸ì‰¬ë˜ê±°ë‚˜ PRì´ ì˜¬ë¼ì˜¬ ê²½ìš° CIê°€ ëŒì•„ê°€ë©´ì„œ ì½”ë“œì— ëŒ€í•œ ë¦°íŠ¸ì™€ í¬ë©”íŒ… ê³¼ì •ì„ ê±°ì¹˜ê³  í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.

## CI ê³¼ì • ìš”ì•½

![CI íŒŒì´í”„ë¼ì¸](CI-pipeline.png)

ê·¸ë˜ì„œ í˜„ì¬ í”„ë¡œì íŠ¸ì˜ íŒŒì´í”„ ë¼ì¸ì€ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì€ë°ìš” ã…ã…  
ê°œë°œì´ ì¡°ê¸ˆë” ì§„í–‰ë˜ê³  ë°°í¬í”Œë«í¼ì„ ëª…í™•íˆ ê²°ì •í•˜ê²Œ ë˜ë©´ CDê¹Œì§€ í¬í•¨í•œ ê¸€ë¡œ ì°¾ì•„ëµ™ê² ìŠµë‹ˆë‹¤.  
ê°ì‚¬í•©ë‹ˆë‹¤

### ì°¸ê³ ìë£Œ

https://err0rcode7.github.io/backend/2021/05/11/%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%BB%A4%EB%B2%84%EB%A6%AC%EC%A7%80.html

```toc

```
